(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-35a36d36"],{"058a":function(e,t,a){"use strict";a.d(t,"h",(function(){return s})),a.d(t,"j",(function(){return n})),a.d(t,"k",(function(){return i})),a.d(t,"l",(function(){return c})),a.d(t,"i",(function(){return l})),a.d(t,"d",(function(){return o})),a.d(t,"a",(function(){return u})),a.d(t,"g",(function(){return d})),a.d(t,"f",(function(){return p})),a.d(t,"c",(function(){return f})),a.d(t,"e",(function(){return h})),a.d(t,"b",(function(){return b}));var r="http://60qb8761xi36.vicp.fun",s=r+"/api/users/getAll",n=r+"/api/users/register",i=r+"/api/users/register_application/approve",c=r+"/api/users",l=r+"/api/users/login",o=r+"/api/questions/categories",u=r+"/api/records/user",d=r+"/api/users/register_application",p=r+"/api/records",f=r+"/api/questions/batch",h=r+"/api/questions/category",b=r+"/api/questions/category"},"1ccd":function(e,t,a){"use strict";a("2cd6")},"2cd6":function(e,t,a){},7896:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",{staticClass:"dashboard-card",attrs:{shadow:"hover"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"card-title"},[e._v("檔案上傳")])]),a("div",{staticStyle:{display:"flex","justify-content":"center"}},[a("el-upload",{staticClass:"upload-demo",attrs:{drag:"",action:"#","auto-upload":!1,"on-change":e.handleFileChange,accept:".xlsx,.xls",multiple:""}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v("將文件拖到此處，或"),a("em",[e._v("點擊上傳")])])])],1),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.importData}},[e._v("導入數據")])],1),e.uploading?a("el-progress",{attrs:{percentage:e.uploadProgress,"text-inside":!0,"stroke-width":18}}):e._e(),e.tableData.length>0?a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{prop:"category",label:"種類",width:"180"}}),a("el-table-column",{attrs:{prop:"question_text",label:"題目",width:"400"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{domProps:{innerHTML:e._s(t.row.question_text)}})]}}],null,!1,333996920)}),a("el-table-column",{attrs:{prop:"answer",label:"答案",width:"100"}}),a("el-table-column",{attrs:{prop:"difficulty",label:"難易度",width:"100"}})],1):e._e()],1)],1)},s=[],n=a("c7eb"),i=a("1da1"),c=(a("fb6a"),a("c19f"),a("ace4"),a("b0c0"),a("e9c4"),a("d3b7"),a("5cc6"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7"),a("058a")),l=a("25ca"),o={data:function(){return{tableData:[],file:null,uploading:!1,uploadProgress:0}},methods:{handleFileChange:function(e){var t=e.name.split(".").pop().toLowerCase();if("xlsx"!==t&&"xls"!==t)return this.$message.error("請上傳 .xlsx 或 .xls 文件"),!1;this.file=e.raw,this.handleUpload()},handleUpload:function(){var e=this;if(this.file){var t=new FileReader;t.onload=function(t){var a=new Uint8Array(t.target.result),r=l["a"](a,{type:"array"}),s=r.Sheets[r.SheetNames[0]],n=l["b"].sheet_to_json(s,{header:1});e.tableData=[];for(var i=1;i<n.length;i++)e.tableData.push({category:n[i][0],question_text:n[i][1]+"(A)"+n[i][3]+"(B)"+n[i][4]+"(C)"+n[i][5]+"(D)"+n[i][6],answer:n[i][2],difficulty:n[i][7]});console.log(e.tableData)},t.readAsArrayBuffer(this.file)}else this.$message.error("請先選擇文件")},importData:function(){var e=this;return Object(i["a"])(Object(n["a"])().mark((function t(){var a,r,s,i,l;return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(0!==e.tableData.length){t.next=3;break}return e.$message.error("請先上傳並解析Excel文件"),t.abrupt("return");case 3:e.uploading=!0,e.uploadProgress=0,t.prev=5,a=e.tableData.length,r=Math.ceil(a/100),s=0;case 9:if(!(s<a)){t.next=20;break}return i=e.tableData.slice(s,s+r),t.next=13,fetch(c["c"],{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});case 13:if(l=t.sent,l.ok){t.next=16;break}throw new Error("上傳數據失敗");case 16:e.uploadProgress=Math.round((s+i.length)/a*100);case 17:s+=r,t.next=9;break;case 20:e.$message.success("數據上傳成功"),e.tableData=[],t.next=28;break;case 24:t.prev=24,t.t0=t["catch"](5),console.error("上傳數據時發生錯誤:",t.t0),e.$message.error("上傳數據失敗，請稍後再試");case 28:return t.prev=28,e.uploading=!1,e.uploadProgress=0,t.finish(28);case 32:case"end":return t.stop()}}),t,null,[[5,24,28,32]])})))()}}},u=o,d=(a("1ccd"),a("2877")),p=Object(d["a"])(u,r,s,!1,null,"c5cafdca",null);t["default"]=p.exports}}]);